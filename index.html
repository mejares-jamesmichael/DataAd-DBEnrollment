<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enrollment Management System</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <header>
            <h1>DATABASE ADMINISTRATION</h1>
            <p>Database: dbenrollment</p>
        </header>

        <!-- Navigation -->
        <nav role="navigation" aria-label="Main navigation">
            <button onclick="showSection('departments')" class="active" data-section="departments">Departments</button>
            <button onclick="showSection('programs')" data-section="programs">Programs</button>
            <button onclick="showSection('instructors')" data-section="instructors">Instructors</button>
            <button onclick="showSection('students')" data-section="students">Students</button>
            <button onclick="showSection('courses')" data-section="courses">Courses</button>
            <button onclick="showSection('terms')" data-section="terms">Terms</button>
            <button onclick="showSection('rooms')" data-section="rooms">Rooms</button>
            <button onclick="showSection('sections')" data-section="sections">Sections</button>
            <button onclick="showSection('enrollments')" data-section="enrollments">Enrollments</button>
        </nav>

        <!-- Main Content -->
        <main role="main">
            <!-- Alert System -->
            <div id="alert" class="alert" role="alert"></div>

            <!-- Departments Section -->
            <section id="departments" class="section active" data-module="departments">
                <div class="controls">
                    <input type="text" id="searchDept" placeholder="Search departments..." onkeyup="loadDepartments()" aria-label="Search departments">
                    <button onclick="openDeptModal()">Add Department</button>
                    <button class="excel-export" onclick="exportToExcel('departments', 'Departments')">Export Excel</button>
                    <button onclick="window.print()">Print</button>
                    <button onclick="openTrashModal('departments')">Trash</button>
                    <button onclick="toggleSort('departments')">Sort ↓</button>
                </div>
                <table id="departmentsTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Code</th>
                            <th>Name</th>
                            <th class="no-print">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="deptTableBody">
                        <tr><td colspan="4">Loading...</td></tr>
                    </tbody>
                </table>
            </section>

            <!-- Programs Section -->
            <section id="programs" class="section" data-module="programs">
                <div class="controls">
                    <input type="text" id="searchProg" placeholder="Search programs..." onkeyup="loadPrograms()" aria-label="Search programs">
                    <button onclick="openProgModal()">Add Program</button>
                    <button class="excel-export" onclick="exportToExcel('programs', 'Programs')">Export Excel</button>
                    <button onclick="window.print()">Print</button>
                    <button onclick="openTrashModal('programs')">Trash</button>
                    <button onclick="toggleSort('programs')">Sort ↓</button>
                </div>
                <table id="programsTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Code</th>
                            <th>Name</th>
                            <th>Department</th>
                            <th class="no-print">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="progTableBody">
                        <tr><td colspan="5">Loading...</td></tr>
                    </tbody>
                </table>
            </section>

            <!-- Instructors Section -->
            <section id="instructors" class="section" data-module="instructors">
                <div class="controls">
                    <input type="text" id="searchInst" placeholder="Search instructors..." onkeyup="loadInstructors()" aria-label="Search instructors">
                    <button onclick="openInstModal()">Add Instructor</button>
                    <button class="excel-export" onclick="exportToExcel('instructors', 'Instructors')">Export Excel</button>
                    <button onclick="window.print()">Print</button>
                    <button onclick="openTrashModal('instructors')">Trash</button>
                    <button onclick="toggleSort('instructors')">Sort ↓</button>
                </div>
                <table id="instructorsTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Department</th>
                            <th class="no-print">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="instTableBody">
                        <tr><td colspan="5">Loading...</td></tr>
                    </tbody>
                </table>
            </section>

            <!-- Students Section -->
            <section id="students" class="section" data-module="students">
                <div class="controls">
                    <input type="text" id="searchStud" placeholder="Search students..." onkeyup="loadStudents()" aria-label="Search students">
                    <button onclick="openStudModal()">Add Student</button>
                    <button class="excel-export" onclick="exportToExcel('students', 'Students')">Export Excel</button>
                    <button onclick="window.print()">Print</button>
                    <button onclick="openTrashModal('students')">Trash</button>
                    <button onclick="toggleSort('students')">Sort ↓</button>
                </div>
                <table id="studentsTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Student No</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Program</th>
                            <th>Year</th>
                            <th class="no-print">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="studTableBody">
                        <tr><td colspan="7">Loading...</td></tr>
                    </tbody>
                </table>
            </section>

            <!-- Courses Section -->
            <section id="courses" class="section" data-module="courses">
                <div class="controls">
                    <input type="text" id="searchCourse" placeholder="Search courses..." onkeyup="loadCourses()" aria-label="Search courses">
                    <button onclick="openCourseModal()">Add Course</button>
                    <button class="excel-export" onclick="exportToExcel('courses', 'Courses')">Export Excel</button>
                    <button onclick="window.print()">Print</button>
                    <button onclick="openTrashModal('courses')">Trash</button>
                    <button onclick="toggleSort('courses')">Sort ↓</button>
                </div>
                <table id="coursesTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Code</th>
                            <th>Title</th>
                            <th>Units</th>
                            <th>Lec Hrs</th>
                            <th>Lab Hrs</th>
                            <th>Department</th>
                            <th class="no-print">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="courseTableBody">
                        <tr><td colspan="8">Loading...</td></tr>
                    </tbody>
                </table>
            </section>

            <!-- Terms Section -->
            <section id="terms" class="section" data-module="terms">
                <div class="controls">
                    <input type="text" id="searchTerm" placeholder="Search terms..." onkeyup="loadTerms()" aria-label="Search terms">
                    <button onclick="openTermModal()">Add Term</button>
                    <button class="excel-export" onclick="exportToExcel('terms', 'Terms')">Export Excel</button>
                    <button onclick="window.print()">Print</button>
                    <button onclick="openTrashModal('terms')">Trash</button>
                    <button onclick="toggleSort('terms')">Sort ↓</button>
                </div>
                <table id="termsTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Code</th>
                            <th>Start Date</th>
                            <th>End Date</th>
                            <th class="no-print">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="termTableBody">
                        <tr><td colspan="5">Loading...</td></tr>
                    </tbody>
                </table>
            </section>

            <!-- Rooms Section -->
            <section id="rooms" class="section" data-module="rooms">
                <div class="controls">
                    <input type="text" id="searchRoom" placeholder="Search rooms..." onkeyup="loadRooms()" aria-label="Search rooms">
                    <button onclick="openRoomModal()">Add Room</button>
                    <button class="excel-export" onclick="exportToExcel('rooms', 'Rooms')">Export Excel</button>
                    <button onclick="window.print()">Print</button>
                    <button onclick="openTrashModal('rooms')">Trash</button>
                    <button onclick="toggleSort('rooms')">Sort ↓</button>
                </div>
                <table id="roomsTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Building</th>
                            <th>Room Code</th>
                            <th>Capacity</th>
                            <th class="no-print">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="roomTableBody">
                        <tr><td colspan="5">Loading...</td></tr>
                    </tbody>
                </table>
            </section>

            <!-- Sections Section -->
            <section id="sections" class="section" data-module="sections">
                <div class="controls">
                    <input type="text" id="searchSection" placeholder="Search sections..." onkeyup="loadSections()" aria-label="Search sections">
                    <button onclick="openSectionModal()">Add Section</button>
                    <button class="excel-export" onclick="exportToExcel('sections', 'Sections')">Export Excel</button>
                    <button onclick="window.print()">Print</button>
                    <button onclick="openTrashModal('sections')">Trash</button>
                    <button onclick="toggleSort('sections')">Sort ↓</button>
                </div>
                <table id="sectionsTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Code</th>
                            <th>Course</th>
                            <th>Term</th>
                            <th>Instructor</th>
                            <th>Schedule</th>
                            <th>Room</th>
                            <th class="no-print">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="sectionTableBody">
                        <tr><td colspan="8">Loading...</td></tr>
                    </tbody>
                </table>
            </section>

            <!-- Enrollments Section -->
            <section id="enrollments" class="section" data-module="enrollments">
                <div class="controls">
                    <input type="text" id="searchEnroll" placeholder="Search enrollments..." onkeyup="loadEnrollments()" aria-label="Search enrollments">
                    <button onclick="openEnrollModal()">Add Enrollment</button>
                    <button class="excel-export" onclick="exportToExcel('enrollments', 'Enrollments')">Export Excel</button>
                    <button onclick="window.print()">Print</button>
                    <button onclick="openTrashModal('enrollments')">Trash</button>
                    <button onclick="toggleSort('enrollments')">Sort ↓</button>
                </div>
                <table id="enrollmentsTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Student</th>
                            <th>Course</th>
                            <th>Section</th>
                            <th>Date Enrolled</th>
                            <th>Status</th>
                            <th>Grade</th>
                            <th class="no-print">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="enrollTableBody">
                        <tr><td colspan="8">Loading...</td></tr>
                    </tbody>
                </table>
            </section>
        </main>
    </div>

    <!-- ========================================== -->
    <!-- MODAL DIALOGS -->
    <!-- ========================================== -->

    <!-- Department Modal -->
    <div id="deptModal" class="modal" role="dialog" aria-labelledby="deptModalTitle" aria-modal="true">
        <div class="modal-content">
            <span class="close" onclick="closeDeptModal()" aria-label="Close">&times;</span>
            <h2 id="deptModalTitle">Add Department</h2>
            <form id="deptForm" onsubmit="saveDepartment(event)">
                <input type="hidden" id="deptId">
                <label for="deptCode">Code:</label>
                <input type="text" id="deptCode" required>
                <label for="deptName">Name:</label>
                <input type="text" id="deptName" required>
                <button type="submit">Save</button>
                <button type="button" onclick="closeDeptModal()">Cancel</button>
            </form>
        </div>
    </div>

    <!-- Program Modal -->
    <div id="progModal" class="modal" role="dialog" aria-labelledby="progModalTitle" aria-modal="true">
        <div class="modal-content">
            <span class="close" onclick="closeProgModal()" aria-label="Close">&times;</span>
            <h2 id="progModalTitle">Add Program</h2>
            <form id="progForm" onsubmit="saveProgram(event)">
                <input type="hidden" id="progId">
                <label for="progCode">Code:</label>
                <input type="text" id="progCode" required>
                <label for="progName">Name:</label>
                <input type="text" id="progName" required>
                <label for="progDept">Department:</label>
                <select id="progDept" required></select>
                <button type="submit">Save</button>
                <button type="button" onclick="closeProgModal()">Cancel</button>
            </form>
        </div>
    </div>

    <!-- Instructor Modal -->
    <div id="instModal" class="modal" role="dialog" aria-labelledby="instModalTitle" aria-modal="true">
        <div class="modal-content">
            <span class="close" onclick="closeInstModal()" aria-label="Close">&times;</span>
            <h2 id="instModalTitle">Add Instructor</h2>
            <form id="instForm" onsubmit="saveInstructor(event)">
                <input type="hidden" id="instId">
                <label for="instFirst">First Name:</label>
                <input type="text" id="instFirst" required>
                <label for="instLast">Last Name:</label>
                <input type="text" id="instLast" required>
                <label for="instEmail">Email:</label>
                <input type="email" id="instEmail" required>
                <label for="instDept">Department:</label>
                <select id="instDept" required></select>
                <button type="submit">Save</button>
                <button type="button" onclick="closeInstModal()">Cancel</button>
            </form>
        </div>
    </div>

    <!-- Student Modal -->
    <div id="studModal" class="modal" role="dialog" aria-labelledby="studModalTitle" aria-modal="true">
        <div class="modal-content">
            <span class="close" onclick="closeStudModal()" aria-label="Close">&times;</span>
            <h2 id="studModalTitle">Add Student</h2>
            <form id="studForm" onsubmit="saveStudent(event)">
                <input type="hidden" id="studId">
                <label for="studNo">Student No:</label>
                <input type="text" id="studNo" required>
                <label for="studFirst">First Name:</label>
                <input type="text" id="studFirst" required>
                <label for="studLast">Last Name:</label>
                <input type="text" id="studLast" required>
                <label for="studEmail">Email:</label>
                <input type="email" id="studEmail" required>
                <label for="studGender">Gender:</label>
                <select id="studGender" required>
                    <option value="">Select</option>
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                </select>
                <label for="studBirth">Birthdate:</label>
                <input type="date" id="studBirth" required>
                <label for="studYear">Year Level:</label>
                <select id="studYear" required>
                    <option value="">Select</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                </select>
                <label for="studProg">Program:</label>
                <select id="studProg" required></select>
                <button type="submit">Save</button>
                <button type="button" onclick="closeStudModal()">Cancel</button>
            </form>
        </div>
    </div>

    <!-- Course Modal -->
    <div id="courseModal" class="modal" role="dialog" aria-labelledby="courseModalTitle" aria-modal="true">
        <div class="modal-content">
            <span class="close" onclick="closeCourseModal()" aria-label="Close">&times;</span>
            <h2 id="courseModalTitle">Add Course</h2>
            <form id="courseForm" onsubmit="saveCourse(event)">
                <input type="hidden" id="courseId">
                <label for="courseCode">Code:</label>
                <input type="text" id="courseCode" required>
                <label for="courseTitle">Title:</label>
                <input type="text" id="courseTitle" required>
                <label for="courseUnits">Units:</label>
                <input type="number" id="courseUnits" required>
                <label for="courseLecHrs">Lecture Hours:</label>
                <input type="number" step="0.1" id="courseLecHrs" required>
                <label for="courseLabHrs">Lab Hours:</label>
                <input type="number" step="0.1" id="courseLabHrs" required>
                <label for="courseDept">Department:</label>
                <select id="courseDept" required></select>
                <button type="submit">Save</button>
                <button type="button" onclick="closeCourseModal()">Cancel</button>
            </form>
        </div>
    </div>

    <!-- Term Modal -->
    <div id="termModal" class="modal" role="dialog" aria-labelledby="termModalTitle" aria-modal="true">
        <div class="modal-content">
            <span class="close" onclick="closeTermModal()" aria-label="Close">&times;</span>
            <h2 id="termModalTitle">Add Term</h2>
            <form id="termForm" onsubmit="saveTerm(event)">
                <input type="hidden" id="termId">
                <label for="termCode">Code:</label>
                <input type="text" id="termCode" required>
                <label for="termStart">Start Date:</label>
                <input type="date" id="termStart" required>
                <label for="termEnd">End Date:</label>
                <input type="date" id="termEnd" required>
                <button type="submit">Save</button>
                <button type="button" onclick="closeTermModal()">Cancel</button>
            </form>
        </div>
    </div>

    <!-- Room Modal -->
    <div id="roomModal" class="modal" role="dialog" aria-labelledby="roomModalTitle" aria-modal="true">
        <div class="modal-content">
            <span class="close" onclick="closeRoomModal()" aria-label="Close">&times;</span>
            <h2 id="roomModalTitle">Add Room</h2>
            <form id="roomForm" onsubmit="saveRoom(event)">
                <input type="hidden" id="roomId">
                <label for="roomBuilding">Building:</label>
                <input type="text" id="roomBuilding" required>
                <label for="roomCode">Room Code:</label>
                <input type="text" id="roomCode" required>
                <label for="roomCapacity">Capacity:</label>
                <input type="number" id="roomCapacity" required>
                <button type="submit">Save</button>
                <button type="button" onclick="closeRoomModal()">Cancel</button>
            </form>
        </div>
    </div>

    <!-- Section Modal -->
    <div id="sectionModal" class="modal" role="dialog" aria-labelledby="sectionModalTitle" aria-modal="true">
        <div class="modal-content">
            <span class="close" onclick="closeSectionModal()" aria-label="Close">&times;</span>
            <h2 id="sectionModalTitle">Add Section</h2>
            <form id="sectionForm" onsubmit="saveSection(event)">
                <input type="hidden" id="sectionId">
                <label for="sectionCode">Section Code:</label>
                <input type="text" id="sectionCode" required>
                <label for="sectionCourse">Course:</label>
                <select id="sectionCourse" required></select>
                <label for="sectionTerm">Term:</label>
                <select id="sectionTerm" required></select>
                <label for="sectionInst">Instructor:</label>
                <select id="sectionInst" required></select>
                <label for="sectionDays">Day Pattern:</label>
                <input type="text" id="sectionDays" placeholder="MWF, TTh" required>
                <label for="sectionStart">Start Time:</label>
                <input type="time" id="sectionStart" required>
                <label for="sectionEnd">End Time:</label>
                <input type="time" id="sectionEnd" required>
                <label for="sectionRoom">Room:</label>
                <select id="sectionRoom" required></select>
                <label for="sectionCap">Max Capacity:</label>
                <input type="number" id="sectionCap" required>
                <button type="submit">Save</button>
                <button type="button" onclick="closeSectionModal()">Cancel</button>
            </form>
        </div>
    </div>

    <!-- Enrollment Modal -->
    <div id="enrollModal" class="modal" role="dialog" aria-labelledby="enrollModalTitle" aria-modal="true">
        <div class="modal-content">
            <span class="close" onclick="closeEnrollModal()" aria-label="Close">&times;</span>
            <h2 id="enrollModalTitle">Add Enrollment</h2>
            <form id="enrollForm" onsubmit="saveEnrollment(event)">
                <input type="hidden" id="enrollId">
                <label for="enrollStud">Student:</label>
                <select id="enrollStud" required></select>
                <label for="enrollSection">Section:</label>
                <select id="enrollSection" required></select>
                <label for="enrollDate">Date Enrolled:</label>
                <input type="date" id="enrollDate" required>
                <label for="enrollStatus">Status:</label>
                <select id="enrollStatus" required>
                    <option value="Enrolled">Enrolled</option>
                    <option value="Dropped">Dropped</option>
                    <option value="Completed">Completed</option>
                    <option value="Failed">Failed</option>
                </select>
                <label for="enrollGrade">Grade (optional):</label>
                <input type="text" id="enrollGrade">
                <button type="submit">Save</button>
                <button type="button" onclick="closeEnrollModal()">Cancel</button>
            </form>
        </div>
    </div>

    <!-- Trash Modal -->
    <div id="trashModal" class="modal" role="dialog" aria-labelledby="trashModalTitle" aria-modal="true">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closeTrashModal()" aria-label="Close">&times;</span>
            <h2 id="trashModalTitle">Trash</h2>
            <div id="trashContent">
                <table id="trashTable">
                    <thead id="trashTableHead"></thead>
                    <tbody id="trashTableBody">
                        <tr><td>Loading...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>